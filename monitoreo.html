<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="pwa/vendor/bootstrap/css/bootstrap.min.css?v=10"
    />
    <link
      href="pwa/vendor/fonts/circular-std/style.css?v=10"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="pwa/libs/css/style.css?v=10" />
    <link
      rel="stylesheet"
      href="pwa/vendor/fonts/fontawesome/css/fontawesome-all.css?v=10"
    />
    <link rel="stylesheet" href="pwa/vendor/vector-map/jqvmap.css?v=10" />
    <link
      href="pwa/vendor/jvectormap/jquery-jvectormap-2.0.2.css?v=10"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="pwa/vendor/charts/chartist-bundle/chartist.css?v=10"
    />
    <link rel="stylesheet" href="pwa/vendor/charts/c3charts/c3.css?v=10" />
    <link
      rel="stylesheet"
      href="pwa/vendor/charts/morris-bundle/morris.css?v=10"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="pwa/vendor/daterangepicker/daterangepicker.css?v=10"
    />
    <link
      rel="icon"
      href="pwa/images/miniaturas/favicon-32x32.png?80172489140"
    />
    <title>Aymat Monitoreo</title>
  </head>

  <body>
    <!-- ============================================================== -->
    <!-- main wrapper -->
    <!-- ============================================================== -->
    <div class="dashboard-main-wrapper">
      <!-- ============================================================== -->
      <!-- navbar -->
      <!-- ============================================================== -->
      <div class="dashboard-header">
        <nav class="navbar navbar-expand-lg bg-white fixed-top">
          <!-- <a class="navbar-brand" href="index.html">AYMAT energia</a> -->
          <a class="navbar-brand" href="app.html"
            ><img
              src="pwa/images/AYMAT-FONDO-HORIZONTAL-W116-H45.png?80172489140"
              alt
              class="img-fluid"
          /></a>

          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse " id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto navbar-right-top">

            </ul>
          </div>
        </nav>
      </div>

      <div
        class="nav-left-sidebar sidebar-dark"
        style="background-color: #14A5A5;"
      >
        <div class="menu-list">
          <nav
            class="navbar navbar-expand-lg navbar-light"
            style="background-color: #14A5A5;"
          >
            <a class="d-xl-none d-lg-none" href="#">Dashboard</a>
            
            <button
              class="navbar-toggler"
              type="button"
              data-toggle="collapse"
              data-target="#navbarNav"
              aria-controls="navbarNav"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav flex-column">
                
                <li class="nav-item">
                  <a class="nav-link active" href="">
                    <h7>
<img src="pwa/images/ICONOS APP_MONITOREO.png">
                      Monitoreo Solar
                    </h7>
                  </a>
                </li>
                
                <li class="nav-item">
                <a class="nav-link" href="#">
                <h7>
<img src="pwa/images/ICONOS APP-CLIMATIZACION PISCINAS.png">
                Calefacción pileta
                </h7>
                </a>
                </li>
                
                <li class="nav-item">
                <a class="nav-link" href="#">
                <h7>
<img src="pwa/images/ICONOS APP-TERMOTANQUES.png">
                Termo solar
                </h7>
                </a>
                </li>
                
                <li class="nav-item">
                  <a class="nav-link" href="#">
                    <h7>
<img src="pwa/images/ICONOS APP-AEROTERMIA.png">
                      Aerotermia
                    </h7>
                  </a>
                </li>
                
                
                <li class="nav-item">
                  <a class="nav-link" href="#">
                    <h7>
<img src="pwa/images/ICONOS%20APP-HUERTA%20INTELIGENTE.png">
                      Huertas inteligentes
                    </h7>
                  </a>
                </li>
                
                
                
                <li class="nav-item">
                  <a class="nav-link" href="#">
                    <h7>
<img src="pwa/images/ICONOS APP-BOMBEO SOLAR.png">
                      Bombeo solar
                    </h7>
                  </a>
                </li>
				
                
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>

    <div class="dashboard-wrapper"  style="
    background-image: url(pwa/images/ARGENTINA-1920x1080.png) !important;
                                      background-position: center !important;
                                      background-size: cover !important;
">
<div class="dashboard-finance"  style="
    background-image: url(pwa/images/ARGENTINA-1920x1080.png) !important;
                                      background-position: center !important;
                                      background-size: cover !important;
">
        <div class="container-fluid dashboard-content">

          <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
              <div class="page-header">
                <h3 class="mb-2">Planta: <span id="plantName"></span></h3> 
                <div class="page-breadcrumb">
                  <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                      <li class="breadcrumb-item">
                        <a href="#" class="breadcrumb-link">Dashboard</a>
                      </li>
                      <li class="breadcrumb-item active" aria-current="page">
                        Monitoreo planta Solar
                      </li>
                    </ol>
                  </nav>
                </div>
              </div>
            </div>
          </div>
  <div class="row">
    
                <div class="col-xl-40">
              <div class="card"  id="card">
                <h5 class="card-header">Flujo de energía</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="col-x4-8" >
                          <img class="img-responsive"             style="width: 100%;
    height: auto;" id="animacion" src="https://aymatenergia.com.ar/pwa/images/not_animate_ds-1.png"/>
                            
                      <div style="
    position: absolute;
    z-index: 1000;
" id="derecha">
                      <h3 class="mb-1">&emsp;Consumo</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;
                                  <span id="activePower3"></span> W
                                </h3> 
                    </div> 
                                            <div style="
    position: absolute;
    z-index: 1000;
" id="arriba">
                      <h3 class="mb-1">&emsp;Produción</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;
                                  <span id="currentPower"></span>
                                </h3> 
                    </div> 
                      
                                            <div style="
    position: absolute;
    z-index: 1000;
" id="abajo">
                                              
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;
                                  <span id="storageCapacity3"></span> %
                                </h3> 
                    </div> 
                      
                                            <div style="
    position: absolute;
    z-index: 1000;
" id="izquierda">
                      <h3 class="mb-1">&emsp;Corriente</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;   
                                  <span id="AMP3"></span> A
                                </h3> 
                    </div> 
    </div>
    </div>      
          
                  </div>
                </div>
              </div>
            </div>
    
    

          
          
  
          
          
          
          
          
          
          
                          <div class="row">
                    <div class="col-xl-4">
                        <div class="card">
                            <h5 class="card-header">Registro Solar</h5>
                            <div class="card-body">
                                <div class="row align-items-center">
                                <div class="icon d-inline-block float-left">
                            <h3 class="mb-1">Día&emsp;</h3>
                            <h3 class="mb-1 font-weight-bold">
                              <span id="todayEnergy"></span> Kw/h&emsp;
                            </h3>
                          </div>
                                    <div class="icon d-inline-block float-none">
                                        <img src="pwa/images/icons8-panel-solar-50.png?80172489140" alt="placeholder 50"
                                            class="img-responsive" />
                                    </div>
                                    <div class="metric-value d-inline-block float-right">
                                        <h3 class="mb-1">&emsp; Mes</h3>
                            <h3 class="mb-1 font-weight-bold">
                              &emsp;
                              <span id="totalEnergy"></span> Kw/h
                            </h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
                            
                    <div class="col-xl-4">
                        <div class="card">
                            <h5 class="card-header">Batería</h5>
                            <div class="card-body">
                                <div class="row align-items-center">
                                  <div class="battery onscreen">
    <div class="bubbles battery-bubbles">
        <span>&nbsp;</span>
    </div>
    <div class="liquid liquid-bg-color">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="300px" height="5px" viewbox="0 0 300 5" enable-background="new 0 0 300 5" xml:space="preserve">
            <path fill="#000" class="wave" d="M300,300V2.5c0,0-0.6-0.1-1.1-0.1c0,0-25.5-2.3-40.5-2.4c-15,0-40.6,2.4-40.6,2.4
            c-12.3,1.1-30.3,1.8-31.9,1.9c-2-0.1-19.7-0.8-32-1.9c0,0-25.8-2.3-40.8-2.4c-15,0-40.8,2.4-40.8,2.4c-12.3,1.1-30.4,1.8-32,1.9
            c-2-0.1-20-0.8-32.2-1.9c0,0-3.1-0.3-8.1-0.7V300H300z" />
        </svg>
    </div><!-- .liquid -->
</div>
                                  
<div class="battery-text onscreen">
    <span id="storageCapacity"></span>
</div>

<div class="page-spacer"></div>
                                  
                                  <!--
                                    <div class="metric-value d-inline-block float-right">
                                                            <h3 class="mb-1">Carga al</h3>
                                
                    </div>
                                  -->
                  </div>
                </div>
              </div>
            </div>  
                            
                            
            
                            
                            
            <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">Ahorro</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    
                                        <div class="icon d-inline-block float-left">
                    <h3 class="mb-1">Factor&emsp;</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  <span id="PrecioKw"></span>
                                  $/Kwh
                                  &emsp;
                                </h3>
                              </div>
                    <div class="icon d-inline-block float-none">
                      <img
src="pwa/images/plata.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                    </div>
                    <div class="metric-value d-inline-block float-right">
                                <h3 class="mb-1">&emsp; Mes</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;
                                  <span id="Preciototal"></span> $
                                </h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          
          
                <div class="row">
                  
                  
                  
                  
                  
                  
                  <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">Producción en tiempo real</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="icon d-inline-block float-left">
                      <img
                        src="pwa/images/icons8-panel-solar-50.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                    </div>
                    <div class="metric-value d-inline-block float-right">
                      <h3 class="mb-1">&emsp;Producción</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;
                                  <span id="currentPower3"></span>
                                </h3>
                      
                      
                      
                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
                  
                  
                  
                  
                  
                  
                  
                  <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">Red en tiempo real</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="icon d-inline-block float-left">
                          <h3 class="mb-1">Voltaje &emsp; </h3>
                            <h3 class="mb-1 font-weight-bold">220 V &emsp; </h3>
                          </div>
                    <div class="icon d-inline-block float-none">
                      <img src="pwa/images/icons8-electricidad-50.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                      <!--src="pwa/images/icons8-electricidad-50.png?80172489140"-->
                      <!--src="pwa/images/animate_png_320.png?80172489140"-->
                    </div>
                    <div class="metric-value d-inline-block float-right">
                            <h3 class="mb-1">&emsp;Corriente</h3>
                            <h3 class="mb-1 font-weight-bold">
                              &emsp;
                              <span id="AMP"></span> Amp
                            </h3>
                      
                      
                      
                      
                      
                      
                      
                    
                      
                      
                      
                      
                      
                      
                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
                  
                  
            
            <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">Consumo en tiempo real</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="icon d-inline-block float-left">
                      <img
                        src="pwa/images/icons8-cabaña-50.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                    </div>
                    <div class="metric-value d-inline-block float-right">
                                
                                <h3 class="mb-1">&emsp; Total</h3>
                                <h3 class="mb-1 font-weight-bold">
                                  &emsp;
                                  <span id="activePower"></span> w
                                </h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

       
          
          
          
          
          
          
          
          <div class="row">
            <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">C02 No emitidos</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="icon d-inline-block float-left">
                      <img
                        src="pwa/images/icons8-co2-50.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                    </div>
                    <div class="metric-value d-inline-block float-right">
                      <h3 class="mb-1 font-weight-bold">
                        &emsp;
                        <span id="Co2Reduction"></span> Kg CO2
                      </h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">Árboles</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="icon d-inline-block float-left">
                      <img
                        src="pwa/images/icons8-brote-50.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                    </div>
                    <div class="metric-value d-inline-block float-right">
                      <h3 class="mb-1 font-weight-bold">
                        &emsp;
                        <span id="Co2tree"></span>  árboles salvados
                      </h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-4">
              <div class="card">
                <h5 class="card-header">Petróleo</h5>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="icon d-inline-block float-left">
                      <img
                        src="pwa/images/icons8-bomba-de-petróleo-gato-50.png?80172489140"
                        alt="placeholder 50"
                        class="img-responsive"
                      />
                    </div>
                    <div class="metric-value d-inline-block float-right">
                      <h3 class="mb-1 font-weight-bold">
                        &emsp;
                        <span id="Co2oil"></span> lts ahorrados
                      </h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
  <script type="text/javascript">
   function show(id) {
    if (document.getElementById) {
     if (document.getElementById(id).style.display != 'block') {
      document.getElementById(id).style.display = 'block';
      document.getElementById(id + '_expand').innerText = 'Esconder los datos avanzados';
     }
     else {
      document.getElementById(id).style.display = 'none';
      document.getElementById(id + '_expand').innerText = 'Mostrar los datos avanzados';
     }
    }
   }
  </script>
          
						<button type="submit" class="btn btn-primary btn-lg btn-block" onclick="javascript:show('tabladatos')"><a id="tabladatos_expand">Mostrar los datos avanzados</a></button>
          
           <!--
           <div class="row" id="tabladatos">

          -->
          
               <div class="row" style="display: none;" id="tabladatos">
            <div class="col-xl-13">
              <div class="card">
                <h2>Tabla de datos avanzados</h2>
<table>
  <tr>
    <th>Nombre de campo</th>
    <th>Valor</th>
  </tr>
  <tr>
    <td>Nombre de planta</td>
    <td><span id="plantName2"></span></td>
  </tr>
  <tr>
    <td>Id de planta</td>
    <td><span id="plantId"></span></td>
  </tr>
  <tr>
    <td>Generación de hoy</td>
    <td><span id="todayEnergy2"></span>Kwh</td>
  </tr>
  <tr>
    <td>Generación del mes</td>
    <td><span id="totalEnergy2"></span>Kwh</td>
  </tr>
    <tr>
    <td>Porcentaje de batería</td>
    <td><span id="storageCapacity2"></span></td>
  </tr>
  <tr>
    <td>Amperaje del consumo</td>
    <td><span id="AMP2"></span>Amp</td>
  </tr>
    <tr>
    <td>Ahorro de dinero del día</td>
    <td><span id="Preciodia"></span> $</td> 
  </tr>
    <tr>
    <td>Ahorro de dinero del mes</td>
    <td><span id="Preciototal2"></span> $</td>
  </tr>
  <tr>
    <td>Producción en tiempo real del panel</td>
    <td><span id="currentPower2"></span></td>
  </tr>
    <tr>
    <td>Consumo instantáneo del hogar</td>
    <td><span id="activePower2"></span></td>
  </tr>
    <tr>
    <td>CO2 no emitidos</td>
    <td><span id="Co2Reduction2"></span></td>
  </tr>
    <tr>
    <td>Árboles salvados</td>
    <td><span id="Co2tree2"></span></td>
  </tr>
    <tr>
    <td>Lts. de petróleo ahorrados</td>
    <td><span id="Co2oil2"></span></td>
  </tr>
    <tr>
    <td>Tipo de central</td>
    <td><span id="deviceAilas"></span> + <span id="deviceType"></span></td>
  </tr>
    <tr>
    <td>Conectado</td>
    <td><span id="lost"></span></td>
  </tr>
    <tr>
    <td>Número de serie de data logger</td>
    <td><span id="datalogSn"></span></td>
  </tr>
      <tr>
    <td>Número de serie de la central</td>
    <td><span id="deviceSn"></span></td>
  </tr>
        <tr>
    <td>Id de funcionamiento</td>
    <td><span id="deviceStatus"></span></td>
  </tr>
  <tr>
    <td>Potencia nominal del aparato</td>
    <td><span id="nominal_Power"></span>w</td>
  </tr>
  <tr>
    <td>Potencia aparente del aparato</td>
    <td><span id="apparentPower"></span>w</td>
  </tr>
</table>
  <div class="row">
      <div class="col-xl-4">
        <div class="card">
          <h5 class="card-header">Generacion solar</h5>
          <div class="card-body">
            <div id="generacion"></div>
        </div>
        </div>
                </div>
         <div class="col-xl-4">
        <div class="card">
          <h5 class="card-header">Produccion y consumo</h5>
          <div class="card-body">
            <div id="solar_casa"></div>
        </div>
        </div>
                </div>       
            <div class="col-xl-4">
        <div class="card">
          <h5 class="card-header">ahorro</h5>
          <div class="card-body">
            <div id="ahorro"></div>
        </div>
        </div>
                </div>          
                
             </div>    
              </div>
            </div>
          </div>
          
          
          
          
          
          
          
          
          
          
          
        </div>
      </div>
      <!-- ============================================================== -->
      <!-- footer -->
      <!-- ============================================================== -->
      <div class="footer">
        <div class="container-fluid">
          <div class="row">
            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
              Copyright © 2020 . All rights reserved. Dashboard by
              <a href="http://vectorfieldstechnologies.com/"
                >Vector Fields Technologies</a
              >.
            </div>
            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
              <div class="text-md-right footer-links d-none d-sm-block">
                <a href="https://aymatenergia.com.ar">Inicio</a>
                <a href="mailto:info@aymatenergia.com.ar">Contacto</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- ============================================================== -->
      <!-- end footer -->
      <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- end wrapper  -->
    <!-- ============================================================== -->

    <!-- ============================================================== -->
    <!-- end main wrapper  -->
    <!-- ============================================================== -->
    <!-- jquery 3.3.1  -->
    <script src="pwa/vendor/jquery/jquery-3.3.1.min.js"></script>
    <!-- bootstap bundle js -->
    <script src="pwa/vendor/bootstrap/js/bootstrap.bundle.js"></script>
    <!-- slimscroll js -->
    <script src="pwa/vendor/slimscroll/jquery.slimscroll.js"></script>
    <!-- chart chartist js -->
    <script src="pwa/vendor/charts/chartist-bundle/chartist.min.js"></script>
    <script src="pwa/vendor/charts/chartist-bundle/Chartistjs.js"></script>
    <script src="pwa/vendor/charts/chartist-bundle/chartist-plugin-threshold.js"></script>
    <!-- chart C3 js -->
    <script src="pwa/vendor/charts/c3charts/c3.min.js"></script>
    <script src="pwa/vendor/charts/c3charts/d3-5.4.0.min.js"></script>
    <!-- chartjs js -->
    <script src="pwa/vendor/charts/charts-bundle/Chart.bundle.js"></script>
    <script src="pwa/vendor/charts/charts-bundle/chartjs.js"></script>
    <!-- sparkline js -->
    <script src="pwa/vendor/charts/sparkline/jquery.sparkline.js"></script>
    <!-- dashboard monitoreo js -->
    <!-- <script src="pwa/libs/js/dashboard-monitoreo.js"></script> -->
    <!-- main js -->
    <script src="pwa/libs/js/main-js.js"></script>
    <!-- gauge js -->
    <script src="pwa/vendor/gauge/gauge.min.js"></script>
    <!-- apexcharts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <!-- installing few libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/downloadjs/1.4.8/download.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <!-- daterangepicker js -->
    <!-- <script src="pwa/libs/js/data.js"></script> -->
    <script
      type="text/javascript"
      src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"
    ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
      
      
      
      

      var queryString = new Array();
      var perc;
      
            if (queryString.length == 0) {
                if (window.location.search.split('?').length > 1) {
                    var params = window.location.search.split('?')[1].split('&');
                    for (var i = 0; i < params.length; i++) {
                        var key = params[i].split('=')[0];
                        var value = decodeURIComponent(params[i].split('=')[1]);
                        queryString[key] = value;
                    }
                }
            }
            if (queryString["user"] != null && queryString["pass"] != null) {
                var user = queryString["user"];
      	        var pass = queryString["pass"];
              
              if (user == "") {
                alert("Por favor ingrese un usuario y contraseña válidos");
                window.location.replace("app.html");
};

};
      

      
      
            async function login() {


        var queryString = new Array();
        $(function () {
            if (queryString.length == 0) {
                if (window.location.search.split('?').length > 1) {
                    var params = window.location.search.split('?')[1].split('&');
                    for (var i = 0; i < params.length; i++) {
                        var key = params[i].split('=')[0];
                        var value = decodeURIComponent(params[i].split('=')[1]);
                        queryString[key] = value;
                    }
                }
            }
            if (queryString["user"] != null && queryString["pass"] != null) {
                var user2 = queryString["user"];// ingresa usuario
                var pass2 = queryString["pass"];// ingresa hash
            }
        });






                const proxy_url = "https://guideahon-aymatbeta2.glitch.me/aymat/plants?u=";
                //const proxy_url = "https://aymat.herokuapp.com/aymat/plants?u=";
                var requestOptions = {
                    method: 'GET',
                    redirect: 'follow'
                };
                //const res = await fetch(proxy_url+proxy_url+"/?u="+user+"&p="+pass, requestOptions);
                const res = await fetch(proxy_url + user+"&p="+pass, requestOptions);
                //const res = await fetch(proxy_url + user+"&p="+pass, requestOptions);
                const datos = await res.json();
                console.log(datos);
                const { plantMoneyText, storageCapacity} = datos;
                datapack2(datos.back.data[0].plantId,datos);
                  
                //console.log(datos.back.data[0].plantId);
                //document.getElementById('plantMoneyText').textContent =plantMoneyText;
                //document.getElementById('storageStatus').textContent = datos.back.data[0].storageStatus;
                document.getElementById('plantName').textContent = datos.back.data[0].plantName;
                document.getElementById('plantName2').textContent = datos.back.data[0].plantName;
                document.getElementById('plantId').textContent = datos.back.data[0].plantId;
                //document.getElementById('storagePCharge').textContent = datos.back.data[0].storagePCharge;
              
                perc = parseInt(datos.back.data[0].storageCapacity, 10);
                if (perc == 99) {
                perc = 100;
                };
              
                document.getElementById('storageCapacity').textContent = perc;
                document.getElementById('storageCapacity2').textContent = perc;
                document.getElementById('storageCapacity3').textContent = perc;

                document.getElementById('currentPower').textContent = datos.back.data[0].currentPower;
                document.getElementById('currentPower2').textContent = datos.back.data[0].currentPower;
                document.getElementById('currentPower3').textContent = datos.back.data[0].currentPower;
                //document.getElementById('isHaveStorage').textContent = datos.back.data[0].isHaveStorage;
                //document.getElementById('todayEnergy').textContent = datos.back.data[0].todayEnergy;
                //document.getElementById('storagePDisCharge').textContent = datos.back.data[0].storagePDisCharge;
                //document.getElementById('PS_energy').textContent = datos.back.data[0].totalEnergy;
                
                var error = datos.back.data[0].plantId;
                if (error == -1) {
                alert("Por favor ingrese un usuario y contraseña válidos");
                window.location.replace("app.html");

};
              
            }
            async function datapack2(plant_id,data1) {
                const proxy_url = "https://guideahon-aymatbeta2.glitch.me/aymat/plant/";
                //const proxy_url = "https://aymat.herokuapp.com/aymat/plant/";
                var requestOptions = {
                    method: 'GET',
                    redirect: 'follow'
                };
                //const res = await fetch(proxy_url+"/?u="+user+"&p="+pass, requestOptions);
                const res = await fetch(proxy_url +plant_id+"?u="+user+"&p="+pass, requestOptions);
                const datos = await res.json();
                console.log(datos);
                const { Co2Reduction, totalEnergy, todayEnergy, useEnergy } = datos;
                //const { datalogSn } = datos.deviceList;
                //plant_id = datos.back.data.plantId;
                //document.getElementById('plantMoneyText').textContent = await datos.plantMoneyText;
                //document.getElementById('optimizerType').textContent = datos.optimizerType;
                //document.getElementById('ammeterType').textContent = datos.ammeterType;
                //document.getElementById('storagePgrid').textContent = datos.storagePgrid;
                document.getElementById('todayEnergy').textContent = todayEnergy;
                document.getElementById('todayEnergy2').textContent = todayEnergy;
                document.getElementById('Preciodia').textContent = (todayEnergy*2.83).toFixed(0);
                //document.getElementById('storageTodayPpv').textContent = datos.storageTodayPpv;
                //document.getElementById('invTodayPpv').textContent = datos.invTodayPpv;
                document.getElementById('totalEnergy').textContent = totalEnergy;
                document.getElementById('totalEnergy2').textContent = totalEnergy;
                document.getElementById('PrecioKw').textContent = 2.83;
                             // document.getElementById('PrecioKw2').textContent = 2.83;
                document.getElementById('Preciototal').textContent = (totalEnergy*2.83).toFixed(0);
                document.getElementById('Preciototal2').textContent = (totalEnergy*2.83).toFixed(0);
                //document.getElementById('nominalPower').textContent = datos.nominalPower;
                //document.getElementById('todayDischarge').textContent = datos.todayDischarge;
                document.getElementById('Co2Reduction').textContent = Co2Reduction;
                document.getElementById('Co2Reduction2').textContent = Co2Reduction;
                document.getElementById('Co2tree').textContent = (Co2Reduction / 2.56).toFixed(0);
                document.getElementById('Co2tree2').textContent = (Co2Reduction / 2.56).toFixed(0);
                document.getElementById('Co2oil').textContent = (Co2Reduction / 3.84).toFixed(1);
                document.getElementById('Co2oil2').textContent = (Co2Reduction / 3.84).toFixed(1);
                //document.getElementById('storagePuser').textContent = datos.storagePuser;
                //document.getElementById('useEnergy').textContent = useEnergy;
                //document.getElementById('totalMoneyText').textContent = datos.totalMoneyText;
                document.getElementById('nominal_Power').textContent = datos.nominal_Power;
                document.getElementById('lost').textContent = datos.deviceList[0].lost;
                //document.getElementById('location').textContent = datos.deviceList[0].location;
                document.getElementById('datalogSn').textContent = datos.deviceList[0].datalogSn;
                document.getElementById('deviceSn').textContent = datos.deviceList[0].deviceSn;
                document.getElementById('deviceStatus').textContent = datos.deviceList[0].deviceStatus;
                //document.getElementById('pCharge').textContent = datos.deviceList[0].pCharge;
                document.getElementById('activePower').textContent = datos.deviceList[0].activePower;
                document.getElementById('activePower2').textContent = datos.deviceList[0].activePower;
                document.getElementById('activePower3').textContent = datos.deviceList[0].activePower;
                document.getElementById('AMP').textContent = (datos.deviceList[0].activePower/220).toFixed(2);
                document.getElementById('AMP2').textContent = (datos.deviceList[0].activePower/220).toFixed(2);
                document.getElementById('AMP3').textContent = (datos.deviceList[0].activePower/220).toFixed(2);
                document.getElementById('deviceAilas').textContent = datos.deviceList[0].deviceAilas;
                document.getElementById('deviceType').textContent = datos.deviceList[0].deviceType;
                //document.getElementById('storageType').textContent = datos.deviceList[0].storageType;
                //document.getElementById('eChargeToday').textContent = datos.deviceList[0].eChargeToday;
                document.getElementById('apparentPower').textContent = datos.deviceList[0].apparentPower;
                //document.getElementById('capacity').textContent = datos.deviceList[0].capacity;
                //document.getElementById('energy').textContent = datos.deviceList[0].energy;
 
              
              
              //--------------------graficos--------------
              
              
              var status=parseInt(datos.deviceList[0].deviceStatus, 10);
              
              

              if(status==8){
              document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds8.png";
                //_Solar&battery
              }else if(status==10){
                document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds10.png";
                //_ACcharge&bypass
              }
              else if(status==11){
              document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds11.png"; // animacion correcta papa!!!
                //_bypass
              }else if(status==12){
                document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds12.png";
                //Solar&Bypass
              }
              
                    //alert(window.screen.availWidth);
                    //document.getElementById("myBtn").style.height = "50px";
              var ancho 
              var img = document.getElementById('animacion'); 
              var card = document.getElementById('card'); 
              var ancho = img.clientWidth;
              var anchocard = card.clientWidth;
              var factor =  parseFloat(ancho)/500;
              //alert(ancho);
              document.getElementById("arriba").style.left = String((anchocard/2)+(40*factor)) + "px";
              document.getElementById("arriba").style.top = String(40*factor+70) + "px";
              
              document.getElementById("abajo").style.left = String((anchocard/2)-48) + "px";
              document.getElementById("abajo").style.top = String(490*factor+70) + "px";
              
              document.getElementById("izquierda").style.left = String((anchocard/2)-(245*factor)) + "px";
              document.getElementById("izquierda").style.top = String(310*factor+70) + "px";
              
              document.getElementById("derecha").style.left = String((anchocard/2)+(115*factor)) + "px";
              document.getElementById("derecha").style.top = String(310*factor+70) + "px";
              //alert(String(factor*ancho) + "px")
              //document.getElementById("abajo").style.left = "50px";
              
              //var produccionancho = 
              //    left: calc(30% + 120px);
                  
              /*
      if(status==8){
              document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds8.png";
                //_Solar&battery
              }else if(status==10){
                document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds10.png";
                //_ACcharge&bypass
              }
              else if(status==11){
              document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds11.png"; // animacion correcta papa!!!
                //_bypass
              }else if(status==12){
                document.getElementById("animacion").src= "https://aymatenergia.com.ar/pwa/images/animate_PNG_ds12.png";
                //Solar&Bypass
              }
              */
              // ---------------------------plots------------
              
              var options1 = {
          series: [todayEnergy, totalEnergy],
          chart: {
          height: 400,
          type: 'radialBar',
        },
        plotOptions: {
          radialBar: {
            offsetY: 0,
            startAngle: 0,
            endAngle: 270,
            hollow: {
              margin: 5,
              size: '30%',
              background: 'transparent',
              image: undefined,
            },
            dataLabels: {
              name: {
                show: false,
              },
              value: {
                show: false,
              }
            }
          }
        },
        colors: ['#5dbcd2', '#4080be'],
        labels: ['Diaria Kw', 'Mes Kw'],
        legend: {
          show: true,
          floating: true,
          fontSize: '16px',
          position: 'left',
          offsetX: -20,
          offsetY: 40,
          labels: {
            useSeriesColors: true,
          },
          markers: {
            size: 0
          },
          formatter: function(seriesName, opts) {
            return seriesName + ":  " + opts.w.globals.series[opts.seriesIndex]
          },
          itemMargin: {
            vertical: 3
          }
        },
        responsive: [{
          breakpoint: 480,
          options: {
            legend: {
                show: false
            }
          }
        }]
        };

        var chart1 = new ApexCharts(document.querySelector("#generacion"), options1);
        chart1.render();
              
              
            var options2 = {
          series: [datos.deviceList[0].activePower, datos.deviceList[0].pCharge],
          chart: {
          height: 400,
          type: 'radialBar',
        },
        plotOptions: {
          radialBar: {
            offsetY: 0,
            startAngle: 0,
            endAngle: 270,
            hollow: {
              margin: 5,
              size: '30%',
              background: 'transparent',
              image: undefined,
            },
            dataLabels: {
              name: {
                show: false,
              },
              value: {
                show: false,
              }
            }
          }
        },
        colors: ['#5dbcd2', '#4080be'],
        labels: ['cons w','Prod w'],
        legend: {
          show: true,
          floating: true,
          fontSize: '16px',
          position: 'left',
          offsetX: -30,
          offsetY: 20,
          labels: {
            useSeriesColors: true,
          },
          markers: {
            size: 0
          },
          formatter: function(seriesName, opts) {
            return seriesName + ":  " + opts.w.globals.series[opts.seriesIndex]
          },
          itemMargin: {
            vertical: 3
          }
        },
        responsive: [{
          breakpoint: 480,
          options: {
            legend: {
                show: false
            }
          }
        }]
        };

        var chart2 = new ApexCharts(document.querySelector("#solar_casa"), options2);
        chart2.render();
              var options3 = {
          series: [(totalEnergy*2.83).toFixed(0), (todayEnergy*2.83).toFixed(0)],
          chart: {
          height: 400,
          type: 'radialBar',
        },
        plotOptions: {
          radialBar: {
            offsetY: 0,
            startAngle: 0,
            endAngle: 270,
            hollow: {
              margin: 5,
              size: '30%',
              background: 'transparent',
              image: undefined,
            },
            dataLabels: {
              name: {
                show: false,
              },
              value: {
                show: false,
              }
            }
          }
        },
        colors: ['#5dbcd2', '#4080be'],
        labels: ['cons w','Prod w'],
        legend: {
          show: true,
          floating: true,
          fontSize: '16px',
          position: 'left',
          offsetX: -30,
          offsetY: 20,
          labels: {
            useSeriesColors: true,
          },
          markers: {
            size: 0
          },
          formatter: function(seriesName, opts) {
            return seriesName + ":  " + opts.w.globals.series[opts.seriesIndex]
          },
          itemMargin: {
            vertical: 3
          }
        },
        responsive: [{
          breakpoint: 480,
          options: {
            legend: {
                show: false
            }
          }
        }]
        };

        var chart3 = new ApexCharts(document.querySelector("#ahorro"), options3);
        chart3.render();
              
            }
      
            login();
      
      function changeStylesheetRule(s, selector, property, value){
    // Make these strings lowercase
    selector = selector.toLowerCase();
    value    = value.toLowerCase();

    // Delete it if it exists
    for(var i = 0; i < s.cssRules.length; i++){
        var rule = s.cssRules[i];
        if(rule.selectorText === selector){
            s.deleteRule(i);
            break;
        }
    }

    // Convert camelCase to hyphenated-case
    property = property.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
    s.insertRule(selector + " { " + property + ": " + value + "; }", 0);
}

// Function to select random array element
// Used within the setInterval()
function randomValue(arr){
    return arr[Math.floor(Math.random() * arr.length)];
}

jQuery.easing['jswing'] = jQuery.easing['swing'];
jQuery.extend(jQuery.easing, {
    def: 'easeOutQuad',
    swing: function (x, t, b, c, d){
        return jQuery.easing[jQuery.easing.def](x, t, b, c, d);
    },
    easeOutQuad: function (x, t, b, c, d){
        return -c * (t /= d) * (t - 2) + b;
    },
});

$(document).ready(function(){
    //var perc = str.match(/(\d+)/);
    var s = document.styleSheets[0];
    // Define a size array, this will be used to vary bubble sizes
    var sArray = [];

    setTimeout(function(){
        updateBattery(perc, s);
        //$('.percentage').text(perc);
        //$('.units').text('%');
        $('.battery-text').css('opacity', 1);
        $('.slider input').animate({ value: perc }, 500, 'easeOutQuad');

        setTimeout(function(){
            $('.liquid').show();
        }, 500);
    }, 500);

    function updateBattery(perc, s){
        if(perc === 100){
            sArray = [];
        } else if(sArray.length === 99){
            sArray = [];
        }

      else if(sArray.length === 0){
            sArray = [4, 6, 8, 10];
        }

        changeStylesheetRule(s, '.battery', 'backgroundPosition', '0 -' + (100 - perc) + '% !important');
        changeStylesheetRule(s, '.battery-text', 'backgroundPosition', '0 -' + (100 - perc) + '%');
        changeStylesheetRule(s, '.liquid', 'top', (100 - perc) + '%');
        if(perc === 100){
            changeStylesheetRule(s, '.liquid-bg-color', 'backgroundColor', '#000');
        } else {
            changeStylesheetRule(s, '.liquid-bg-color', 'backgroundColor', '#444');
        }
    }

    // setInterval function used to create new bubble every 350 milliseconds
    setInterval(function(){
        if(sArray.length > 0){
            // Get a random size, defined as variable so it can be used for both width and height
            var size = randomValue(sArray);

            var largestSize = Math.max.apply(Math, sArray);
            var offset = largestSize / 2; // half to get the largest bubble radius
            offset += 5; // 5px for border-right

            // New bubble appended to div with it's size and left position being set inline
            $('.bubbles').each(function(){
                var bArray = new Array(parseInt($(this).width()) - offset)
                                 .join()
                                 .split(',')
                                 .map(function(item, index){ return ++index; });

                $(this).append('<div class="individual-bubble" style="left: ' + randomValue(bArray) + 'px; width: ' + size + 'px; height: ' + size + 'px"></div>');
            });

            // Animate each bubble to the top (bottom 100%) and reduce opacity as it moves
            // Callback function used to remove finished animations from the page
            $('.individual-bubble').animate({
                'top': 0,
                'bottom': '100%',
                'opacity' : '-=0.7',
            }, 3000, function(){
                $(this).remove();
            });
        }
    }, 350);

    $('.slider input').on('input', function(){
        $(this).stop(); // Terminate any running animation
        var original = this.value;
        // Set slider back to its starting value so we can animate the change
        this.value = perc;
        perc = parseInt(original);
        $(this).animate({ value: perc }, 500, 'easeOutQuad');
        $('.percentage').text(perc);
    }).on('mouseup', function(){
        // We need to manually call this to make sure things bubble up to the change event
        $(this).trigger('change');
    }).on('change', function(){
        updateBattery(30, s);
    });
});
    </script>
  </body>
</html>
